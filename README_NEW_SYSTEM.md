# نظام TIEC الجديد - دليل الاستخدام

## نظرة عامة

النظام الجديد عبارة عن منصة شاملة لإدارة الخدمات التدريبية والاستشارية في TIEC، مع نظام تسجيل ذكي وحضور آلي.

## الميزات الجديدة

### 1. أنواع الخدمات المتعددة
- **التدريبات المتاحة (Training)**: تدريبات مهنية مع مدربين محددين
- **الاستشارات الفردية (Mentoring)**: استشارات للأفراد والشركات
- **معمل التصنيع الرقمي (FabLab)**: حجز فترات عمل
- **مساحة العمل الحرة (Co-Working Space)**: حجز مساحات عمل

### 2. نظام Token الذكي
- كل مشارك يحصل على token فريد
- إمكانية التسجيل باستخدام الـ token بدلاً من إعادة إدخال البيانات
- نظام QR code للوصول السريع

### 3. نظام الحضور الذكي
- QR Scanner لتسجيل الحضور
- إمكانية البحث بالرقم القومي
- تتبع الحضور والغياب

### 4. أسئلة مخصصة لكل خدمة
- أسئلة مختلفة حسب نوع الخدمة
- نظام chain select للأسئلة المرتبطة
- إجابات محفوظة مع كل تسجيل

## كيفية التحديث

### الخطوة 1: نسخ احتياطي
```bash
# نسخ قاعدة البيانات الحالية
mysqldump -u root -p tiec_form > backup_before_update.sql
```

### الخطوة 2: تشغيل ملف التحديث
```bash
# تشغيل ملف تحديث قاعدة البيانات
php update_database.php
```

### الخطوة 3: التحقق من التحديث
```bash
# التحقق من وجود الجداول الجديدة
php check_database.php
```

## هيكل قاعدة البيانات الجديد

### الجداول الرئيسية

#### 1. جدول participants
```sql
- id (PK)
- name
- national_id (unique)
- phone
- email
- governorate
- gender
- age
- participant_type
- token (unique, auto-generated)
- created_at
- updated_at
```

#### 2. جدول services
```sql
- id (PK)
- name_ar
- name_en
- description_ar
- description_en
- service_type (training/mentoring/fablab/coworking)
- is_active
- sort_order
- created_at
- updated_at
```

#### 3. جدول trainings
```sql
- id (PK)
- service_id (FK)
- trainer_id (FK)
- title_ar
- title_en
- description_ar
- description_en
- start_date
- end_date
- start_time
- end_time
- max_participants
- current_participants
- is_active
- created_at
- updated_at
```

#### 4. جدول registrations
```sql
- id (PK)
- participant_id (FK)
- service_id (FK)
- training_id (FK, nullable)
- registration_date
- status (pending/confirmed/cancelled)
- answers (JSON)
- created_at
- updated_at
```

#### 5. جدول attendance
```sql
- id (PK)
- participant_id (FK)
- training_id (FK)
- attendance_date
- check_in_time
- check_out_time
- status (present/absent/late)
- created_at
```

## سيناريوهات الاستخدام

### سيناريو 1: تسجيل جديد
1. المستخدم يدخل الموقع
2. يختار نوع الخدمة
3. تظهر أسئلة مخصصة للخدمة
4. يملأ البيانات الشخصية
5. يتم إنشاء token فريد
6. يتم حفظ التسجيل مع الإجابات

### سيناريو 2: تسجيل بواسطة token
1. المستخدم يدخل token
2. النظام يتحقق من صحة الـ token
3. يظهر بياناته المحفوظة
4. يمكنه التسجيل في خدمة جديدة

### سيناريو 3: تسجيل الحضور
1. صفحة QR Scanner
2. مسح QR code أو إدخال الرقم القومي
3. التحقق من وجود تسجيل في تاريخ اليوم
4. تسجيل الحضور تلقائياً

## الملفات الجديدة المطلوبة

### 1. صفحة QR Scanner
```php
// attendance_scanner.php
- QR code scanner
- إدخال الرقم القومي
- تسجيل الحضور
```

### 2. صفحة Token Login
```php
// token_login.php
- إدخال الـ token
- التحقق من صحة الـ token
- عرض بيانات المستخدم
```

### 3. صفحة إدارة التدريبات
```php
// admin/trainings_manager.php
- إدارة التدريبات
- تعيين المدربين
- تحديد المواعيد
```

### 4. صفحة إدارة الحضور
```php
// admin/attendance_manager.php
- عرض الحضور
- تقارير الحضور
- إدارة الغياب
```

## التحسينات المقترحة

### 1. ميزات الأمان
- تشفير الـ tokens
- صلاحية زمنية للـ tokens
- نظام تنبيهات للـ tokens المفقودة

### 2. تحسين تجربة المستخدم
- إشعارات SMS/Email للتأكيد
- تقويم تفاعلي لحجز المواعيد
- نظام تقييم للخدمات

### 3. ميزات إدارية
- لوحة تحكم للمدربين
- تقارير تفصيلية
- نظام إشعارات للمديرين

### 4. ميزات تقنية
- API للربط مع أنظمة خارجية
- نظام backup تلقائي
- تحليلات متقدمة

## مراحل التطوير

### المرحلة الأولى (الأسبوع 1-2)
- [x] تحديث قاعدة البيانات
- [x] إنشاء الجداول الجديدة
- [ ] تحديث واجهة التسجيل
- [ ] إضافة نظام الـ token

### المرحلة الثانية (الأسبوع 3-4)
- [ ] إنشاء صفحة QR Scanner
- [ ] إنشاء صفحة Token Login
- [ ] تحديث لوحة التحكم
- [ ] إضافة إدارة التدريبات

### المرحلة الثالثة (الأسبوع 5-6)
- [ ] إضافة نظام الحضور
- [ ] إنشاء التقارير
- [ ] اختبار النظام
- [ ] تدريب المستخدمين

## ملاحظات مهمة

### 1. الأمان
- تشفير البيانات الحساسة
- التحقق من صحة المدخلات
- حماية من SQL Injection

### 2. الأداء
- فهرسة قاعدة البيانات
- تحسين الاستعلامات
- نظام cache للبيانات المتكررة

### 3. المرونة
- إمكانية إضافة أنواع خدمات جديدة
- تخصيص الأسئلة حسب الحاجة
- نظام صلاحيات مرن

## الدعم الفني

في حالة وجود أي مشاكل أو استفسارات:
- تحقق من ملف `system_scenario.txt` للتفاصيل الكاملة
- راجع ملف `database_schema.sql` لهيكل قاعدة البيانات
- استخدم ملف `update_database.php` للتحديث الآمن

## الخلاصة

النظام الجديد يوفر:
- ✅ مرونة أكبر في إدارة الخدمات
- ✅ نظام تسجيل ذكي
- ✅ تتبع الحضور الآلي
- ✅ واجهة مستخدم محسنة
- ✅ قاعدة بيانات منظمة
- ✅ إمكانية التوسع المستقبلي 